<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ruposri - Dashboard</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header>
    <h1>Ruposri Shop</h1>
    <button onclick="logout()">Logout</button>
  </header>

  <main>
    <div class="products-grid" id="products-container">
      <!-- Products load here -->
    </div>

    <div class="cart" id="cart">
      <h3>Your Cart</h3>
      <div id="cart-items"></div>
      <button onclick="checkout()">Checkout</button>
    </div>
  </main>

  <script src="/js/firebase.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/firestore.js"></script>
  <script>
    // Load products on page load
    window.addEventListener('DOMContentLoaded', () => {
      getProducts().then(querySnapshot => {
        const container = document.getElementById('products-container');
        querySnapshot.forEach(doc => {
          const product = doc.data();
          container.innerHTML += `
            <div class="product-card">
              <img src="${product.imageURL}">
              <h3>${product.name}</h3>
              <p>$${product.price}</p>
              <button onclick="addToCart('${doc.id}')">Add to Cart</button>
            </div>
          `;
        });
      });
    });

    // Cart functionality
    let cart = [];

    function addToCart(productId) {
      cart.push(productId);
      updateCartUI();
    }

    function updateCartUI() {
      document.getElementById('cart-items').innerHTML = 
        cart.map(id => `<div>Product: ${id}</div>`).join('');
    }

    function checkout() {
      const user = auth.currentUser;
      cart.forEach(productId => {
        createOrder(user.uid, productId, 1);
      });
      alert('Order placed!');
      cart = [];
      updateCartUI();
    }
  </script>
</body>
</html>